---
layout: post
title:  "网络编程-Socket (一)"
date:   2019-08-15 11:49:51 +0800
categories: Java
tag: Java
---

* content
{:toc}

&emsp;&emsp;Socket套接字,可以实现服务器和客户端之间的通信下面是客户端向服务器发送信息的单向通信.

* 实现连接的方法
    1. `new ServerSocket(port)` 服务端通过`port`开启一个服务器
    2. `new Socket(address, port)` 客户端通过指定服务的 `address` 和 `port` 连接对应服务器

## 单向通信

* 实现单向通信
  * Client
    1. create Socket *创建 Socket*
    2. socket getOutputStream *通过Socket中 getOutPutStream 方法向服务器传输信息*
    3. create DataOutputStream *通过 DataOutPutStream 发送消息*
    4. close *客户端断开连接后 释放资源*
  * Server
    1. create ServerSocket *创建 ServerSocket*
    2. socke.accept *通过Socket中的accept阻塞线程,等待客户端连接*
    3. socket.getInputStream *通过 getInputStream 等待客户端传输信息*
    4. create DataInputStream *通过 DataInputStream 接收消息*
    5. close *服务器关闭后释放资源*

### Client ->

```java
/**
 * @author Zzzxb  2019/8/15 9:56
 * @description: A Java Program for a Client
 */
public class ClientCore {
    // initialize socket and input output streams
    private Socket socket = null;
    private BufferedReader input = null;
    private DataOutputStream out = null;

    // constructor to put ip address and port
    public ClientCore(String address, int port) {
        // establish a connection
        try {
            socket = new Socket(address, port);
            System.out.println("Connected");

            /*
            * readLine int the DataInputStream is outdated
            * input = new DataInputStream(System.in);
            * takes input from terminal
            */
            input = new BufferedReader(new InputStreamReader(System.in));

            // sends output to the socket
            out = new DataOutputStream(socket.getOutputStream());
        } catch (UnknownHostException u) {
            System.out.println(u);
        } catch (IOException i) {
            System.out.println(i);
        }

        // string to read message from input
        String line = "";

        // keep reading until "Over" is input
        while (!line.equals("Over")) {
            try {
                line = input.readLine();
                out.writeUTF(line);
            } catch (IOException i) {
                System.out.println(i);
            }
        }

        // close the connection
        try {
            input.close();
            out.close();
            socket.close();
        } catch (IOException i) {
            System.out.println(i);
        }
    }

    public static void main(String args[]) {
        ClientCore clientCore = new ClientCore("127.0.0.1", 5000);
    }
}
```

### Server <-

```java
/**
 * @author Zzzxb  2019/8/15 9:56
 * @description: A Java program for a Server
 */
public class ServerCore {
    // initialize socket and input stream
    private Socket socket = null;
    private ServerSocket server = null;
    private DataInputStream in = null;

    // constructor with port
    public ServerCore(int port) {
        // starts server and waits for a connection
        try {
            server = new ServerSocket(port);
            System.out.println("Server started");

            System.out.println("Waiting for a client ...");

            socket = server.accept();
            System.out.println("Client accepted");

            // takes input from the client socket
            in = new DataInputStream(
                    new BufferedInputStream(socket.getInputStream()));

            String line = "";

            // reads message from client until "Over" is sent
            while (!line.equals("Over")) {
                try {
                    line = in.readUTF();
                    System.out.println(line);
                } catch (IOException i) {
                    System.out.println(i);
                }
            }
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    public static void main(String[] args) {
        ServerCore serverCore = new ServerCore(5000);
    }
}
```

![socket]({{ '/styles/images/socket.gif' | prepend: site.baseurl  }})

## 双向通信

&emsp;&emsp;在单向通信基础上为服务器增加一个接受信息的方法，为客户端增加一个发送信息的方法.

### Client <->

```java
```

### Server <->

```java
```

## 多人通信

### Client *->

### Server ct<-s<-*

### ClientThread c<-ct

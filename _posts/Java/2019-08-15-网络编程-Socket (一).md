---
layout: post
title:  "网络编程-Socket (一)"
date:   2019-08-15 11:49:51 +0800
categories: Java
tag: Java
---

* content
{:toc}

&emsp;&emsp;Socket套接字,可以实现服务器和客户端之间的通信下面是客户端向服务器发送信息的单向通信.

## 单向通信

### Client

```java
/**
 * @author Zzzxb  2019/8/15 9:56
 * @description: A Java Program for a Client
 */
public class ClientCore {
    // initialize socket and input output streams
    private Socket socket = null;
    private BufferedReader input = null;
    private DataOutputStream out = null;

    // constructor to put ip address and port
    public ClientCore(String address, int port) {
        // establish a connection
        try {
            socket = new Socket(address, port);
            System.out.println("Connected");

            /*
            * readLine int the DataInputStream is outdated
            * input = new DataInputStream(System.in);
            * takes input from terminal
            */
            input = new BufferedReader(new InputStreamReader(System.in));

            // sends output to the socket
            out = new DataOutputStream(socket.getOutputStream());
        } catch (UnknownHostException u) {
            System.out.println(u);
        } catch (IOException i) {
            System.out.println(i);
        }

        // string to read message from input
        String line = "";

        // keep reading until "Over" is input
        while (!line.equals("Over")) {
            try {
                line = input.readLine();
                out.writeUTF(line);
            } catch (IOException i) {
                System.out.println(i);
            }
        }

        // close the connection
        try {
            input.close();
            out.close();
            socket.close();
        } catch (IOException i) {
            System.out.println(i);
        }
    }

    public static void main(String args[]) {
        ClientCore clientCore = new ClientCore("127.0.0.1", 5000);
    }
}
```

### Server

```java
/**
 * @author Zzzxb  2019/8/15 9:56
 * @description: A Java program for a Server
 */
public class ServerCore {
    // initialize socket and input stream
    private Socket socket = null;
    private ServerSocket server = null;
    private DataInputStream in = null;

    // constructor with port
    public ServerCore(int port) {
        // starts server and waits for a connection
        try {
            server = new ServerSocket(port);
            System.out.println("Server started");

            System.out.println("Waiting for a client ...");

            socket = server.accept();
            System.out.println("Client accepted");

            // takes input from the client socket
            in = new DataInputStream(
                    new BufferedInputStream(socket.getInputStream()));

            String line = "";

            // reads message from client until "Over" is sent
            while (!line.equals("Over")) {
                try {
                    line = in.readUTF();
                    System.out.println(line);
                } catch (IOException i) {
                    System.out.println(i);
                }
            }
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    public static void main(String[] args) {
        ServerCore serverCore = new ServerCore(5000);
    }
}
```

![socket]({{ '/styles/images/socket.gif' | prepend: site.baseurl  }})

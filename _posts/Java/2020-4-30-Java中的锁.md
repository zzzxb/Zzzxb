---
layout: post
title:  "Java中的锁"
date:   2020-4-12 01:08:00 +0800
categories: Java
tag: Java
---

* content
{:toc}

内容不完整，后期晋阶的时候回来补上

## 乐观锁

在操作共享资源的时候总以为别人不会来修改资源，所以不会进行加锁。当修改资源的时候查看资源是否被修改过(被改过进行重试或报错,否则就更新资源);

## 悲观锁

在操作共享资源的时候，总感觉别人会修改资源，所以会先加锁，再进行操作。

## 自旋锁

获取锁失败后循环获取锁，超过10就进行阻塞，升级成重量级锁

## 自适应自旋锁

记录一个锁在多次自旋后获取到锁的概率，根据这个概率选择是直接进行阻塞，还是一直自旋

## 锁状态

### 无锁

像 CAS 就是一个无锁操作，相对有锁他的性能增加了不少。

### 偏向锁

一个同步代码块一直被一个线程获取，那么升级成偏向锁之后，每次不用获取锁解锁了，他会通过一次 cas 操作把锁的版本以及线程id进行修改。同时也避免了单个线程进行加锁、解锁带来的性能损耗

### 轻量级锁

同步非阻塞，自旋锁就一个轻量级锁，获取锁失败后不会被阻塞，他会重新获取锁，或者报错。

### 重量级锁

同步阻塞， 在线程获取失败后会进行阻塞。等待其他线程执行完，唤醒所有未获的到锁的线程重新一轮的竞争。

## 公平锁

每来一个线程，就把其加入到线程队列，进行排队获取锁。

## 非公平锁

新来一个线程，可以插队获取锁，当插队失败时进行排队获取锁。

## 重入锁

同步代码块获取到锁后，子同步代码块也能去使用这个锁.

## 非可重入锁

同步代码块获取到锁后，子同步代码块不能去获取锁。

## 独享锁(排它锁)

在进行读写操作的时候只能有一个线程去访问

## 共享锁

在进行读写操作的时候只能有一个线程去写，多个线程去读。但不能同时进行读和写。